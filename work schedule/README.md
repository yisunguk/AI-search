# 작업계획 자동화 시스템 (Work Schedule Automation)

협력사에서 받은 텍스트 형태의 작업계획을 AI(Gemini Flash 2.0)로 분석하여, 엑셀 양식에 자동으로 입력해주는 웹 애플리케이션입니다.

## 주요 기능

1. **엑셀 양식 관리**
   - 현장에서 사용하는 작업계획서 엑셀 파일을 등록
   - 공사구분(토공, 배수공 등) 제목 위치 자동 스캔
   - 데이터가 입력될 열(위치, 작업내용, 인원, 장비) 매핑 설정

2. **AI 작업계획 파싱**
   - 카카오톡이나 문자로 받은 줄글 형태의 작업계획 텍스트 입력
   - Google Gemini 2.0 Flash 모델을 사용하여 구조화된 데이터로 변환
   - 공사구분, 위치, 작업내용, 인원, 장비 정보 자동 추출

3. **엑셀 자동 생성**
   - 파싱된 데이터를 바탕으로 엑셀 파일 생성
   - 각 공사구분에 맞는 위치를 찾아 자동으로 데이터 입력
   - 기존 양식의 서식 유지

## 기술 스택

- **Backend**: Node.js, Express
- **Frontend**: HTML5, CSS3, Vanilla JavaScript
- **AI**: Google Gemini API (`gemini-2.0-flash-exp`)
- **Excel**: ExcelJS
- **File Upload**: Multer

## 설치 및 실행 방법

### 1. 사전 요구사항

- Node.js (v14 이상) 설치 필요
- Google Gemini API Key 필요

### 2. 설치

```bash
# 의존성 패키지 설치
npm install
```

### 3. 환경변수 설정

프로젝트 루트에 `.env` 파일이 생성되어 있어야 합니다. (이미 설정됨)

```
GEMINI_API_KEY=your_api_key_here
PORT=3000
```

### 4. 실행

```bash
# 서버 실행
npm start

# 또는 개발 모드 (nodemon 필요)
npm run dev
```

### 5. 사용 방법

1. 브라우저에서 `http://localhost:3000` 접속
2. **[엑셀 양식 관리]** 탭에서 작업계획서 엑셀 파일 업로드 및 등록
3. **[작업계획 작성]** 탭으로 이동
4. 등록한 양식 선택 후 협력사 작업계획 텍스트 붙여넣기
5. **[AI 파싱 실행]** 버튼 클릭하여 결과 확인
6. **[엑셀 다운로드]** 버튼을 눌러 완성된 파일 저장

## 주의사항

- 엑셀 양식은 `.xlsx` 형식만 지원합니다.
- 공사구분 텍스트(예: "토공", "배수공")가 엑셀 시트에 명확히 기재되어 있어야 정확한 위치를 찾을 수 있습니다.
